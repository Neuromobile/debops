{# Copyright (C) 2021 Pedro Luis Lopez <pedroluis.lopezsanchez@gmail.com>
 # Copyright (C) 2021 DebOps <https://debops.org/>
 # SPDX-License-Identifier: GPL-3.0-only
 #}
{% set ghostunnel__tpl_ferm = [] %}
{% for server in ghostunnel__combined_servers %}
{%   set _ = ghostunnel__tpl_ferm.append({
   'name': 'ghostunnel_' + server.name|replace('-','_'),
   'type': 'accept',
   'dport': server.listen.split(":")[1]|string,
   'saddr': server.allow|d([]),
   'accept_any': not server.disable_authentication|d(True)|bool,
   'role': 'ghostunnel'
}) %}
{% endfor %}
{{ ghostunnel__tpl_ferm }}